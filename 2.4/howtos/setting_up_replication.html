



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-xtrabackup-docs/2.4/2.4/howtos/setting_up_replication.html">
      
      
      
      <link rel="icon" href="../_static/percona-favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.15">
    
    
      
        <title>How to setup a replica for replication in 6 simple steps with Percona XtraBackup - Percona XtraBackup</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="../css/percona.css">
    
      <link rel="stylesheet" href="../css/nocopy.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-343802-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
              

              <script>
              (function (w, d, s, l, i) {
                  w[l] = w[l] || []; w[l].push({
                    'gtm.start': new Date().getTime(), 
                    event: 'gtm.js'
                  });
                  var f = d.getElementsByTagName(s)[0],
                  j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
                  j.async = true; 
                  j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                  f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-K48FGP2');
              </script>
              
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-setup-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docs.percona.com" title="Percona XtraBackup" class="md-header__button md-logo" aria-label="Percona XtraBackup" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Percona XtraBackup
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to setup a replica for replication in 6 simple steps with Percona XtraBackup
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/pxb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxb-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.percona.com" title="Percona XtraBackup" class="md-nav__button md-logo" aria-label="Percona XtraBackup" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    Percona XtraBackup
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/pxb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxb-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro.html" class="md-nav__link">
        About Percona XtraBackup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how_xtrabackup_works.html" class="md-nav__link">
        How Percona XtraBackup Works
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup-version-numbers.html" class="md-nav__link">
        Understand version numbers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        Installing Percona XtraBackup 2.4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/apt_repo.html" class="md-nav__link">
        Installing Percona XtraBackup on Debian and Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/yum_repo.html" class="md-nav__link">
        Installing Percona XtraBackup on Red Hat Enterprise Linux and CentOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/binary-tarball.html" class="md-nav__link">
        Installing Percona XtraBackup from a Binary Tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/compiling_xtrabackup.html" class="md-nav__link">
        Compiling and Installing from Source Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Run in Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Run in Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/docker.html" class="md-nav__link">
        Running Percona XtraBackup in a Docker container
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Prerequisites
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Prerequisites
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_xtrabackup/privileges.html" class="md-nav__link">
        Connection and Privileges Needed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_xtrabackup/configuring.html" class="md-nav__link">
        Configuring xtrabackup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Backup Scenarios
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Backup Scenarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/full_backup.html" class="md-nav__link">
        The Backup Cycle - Full Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/incremental_backup.html" class="md-nav__link">
        Incremental Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/compressed_backup.html" class="md-nav__link">
        Compressed Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/encrypted_backup.html" class="md-nav__link">
        Encrypted Backup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          User’s Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          User’s Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual.html" class="md-nav__link">
        Percona XtraBackup User Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Advanced Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Advanced Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/throttling_backups.html" class="md-nav__link">
        Throttling Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/lockless_bin-log.html" class="md-nav__link">
        Lockless binary log information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/encrypted_innodb_tablespace_backups.html" class="md-nav__link">
        Encrypted InnoDB Tablespace Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/locks.html" class="md-nav__link">
        `lock-ddl-per-table` Option Improvements
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Tutorials, Recipes, How-tos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Tutorials, Recipes, How-tos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-tos.html" class="md-nav__link">
        How-tos and Recipes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
      
      
      
        <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
          Release notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10_1">
          <span class="md-nav__icon md-icon"></span>
          Release notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes.html" class="md-nav__link">
        Release notes index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.27.html" class="md-nav__link">
        Percona XtraBackup 2.4.27 (2022-12-06)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.26.html" class="md-nav__link">
        Percona XtraBackup 2.4.26
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.25.html" class="md-nav__link">
        Percona XtraBackup 2.4.25
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.24.html" class="md-nav__link">
        Percona XtraBackup 2.4.24
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.23.html" class="md-nav__link">
        Percona XtraBackup 2.4.23
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.22.html" class="md-nav__link">
        Percona XtraBackup 2.4.22
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.21.html" class="md-nav__link">
        Percona XtraBackup 2.4.21
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.20.html" class="md-nav__link">
        Percona XtraBackup 2.4.20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.19.html" class="md-nav__link">
        Percona XtraBackup 2.4.19
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.18.html" class="md-nav__link">
        Percona XtraBackup 2.4.18
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.17.html" class="md-nav__link">
        Percona XtraBackup 2.4.17
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.16.html" class="md-nav__link">
        Percona XtraBackup 2.4.16
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.15.html" class="md-nav__link">
        Percona XtraBackup 2.4.15
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.14.html" class="md-nav__link">
        Percona XtraBackup 2.4.14
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.13.html" class="md-nav__link">
        Percona XtraBackup 2.4.13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.12.html" class="md-nav__link">
        Percona XtraBackup 2.4.12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.11.html" class="md-nav__link">
        Percona XtraBackup 2.4.11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.10.html" class="md-nav__link">
        Percona XtraBackup 2.4.10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.9.html" class="md-nav__link">
        Percona XtraBackup 2.4.9
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.8.html" class="md-nav__link">
        Percona XtraBackup 2.4.8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.7-2.html" class="md-nav__link">
        Percona XtraBackup 2.4.7-2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.7.html" class="md-nav__link">
        Percona XtraBackup 2.4.7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.6.html" class="md-nav__link">
        Percona XtraBackup 2.4.6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.5.html" class="md-nav__link">
        Percona XtraBackup 2.4.5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.4.html" class="md-nav__link">
        Percona XtraBackup 2.4.4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.3.html" class="md-nav__link">
        Percona XtraBackup 2.4.3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.2.html" class="md-nav__link">
        Percona XtraBackup 2.4.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.4/2.4.1.html" class="md-nav__link">
        Percona XtraBackup 2.4.1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/xbk_option_reference.html" class="md-nav__link">
        The xtrabackup Option Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../innobackupex/innobackupex_option_reference.html" class="md-nav__link">
        The innobackupex Option Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud.html" class="md-nav__link">
        The xbcloud Binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_exbackoff.html" class="md-nav__link">
        Exponential Backoff
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_azure.html" class="md-nav__link">
        Using the xbcloud binary with Microsoft Azure Cloud Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcrypt/xbcrypt.html" class="md-nav__link">
        The xbcrypt binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbstream/xbstream.html" class="md-nav__link">
        The xbstream binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../known_issues.html" class="md-nav__link">
        Known issues and limitations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup-files.html" class="md-nav__link">
        Index of files created by Percona XtraBackup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trademark-policy.html" class="md-nav__link">
        Trademark policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyright-and-licensing-information.html" class="md-nav__link">
        Copyright and licensing information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../version-check.html" class="md-nav__link">
        Version Checking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
    <br/>
   <label class="md-nav__title" for="__drawer">
    <a href="https://learn.percona.com/download-percona-xtrabackup-2-4-manual" onclick="_gaq.push(['b._trackEvent', 'Percona XtraBackup', 'Download', 'Download Manual Percona XtraBackup']);" class="md-nav__link md-nav__link--active">
      Download PDF
    </a>
  </label> 
  </ul>
</nav>

                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#all-the-things-you-will-need" class="md-nav__link">
    All the things you will need
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-make-a-backup-on-the-source-and-prepare-it" class="md-nav__link">
    STEP 1: Make a backup on the Source and prepare it
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-copy-backed-up-data-to-the-replica" class="md-nav__link">
    STEP 2:  Copy backed up data to the Replica
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-configure-the-source-mysql-server" class="md-nav__link">
    STEP 3: Configure the Source MySQL server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-configure-the-replica-mysql-server" class="md-nav__link">
    STEP 4: Configure the Replica MySQL server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-start-the-replication" class="md-nav__link">
    STEP 5: Start the replication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-check" class="md-nav__link">
    STEP 6: Check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-more-replicas-to-the-source" class="md-nav__link">
    Adding more replicas to the Source
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                <!-- Edit and view button -->
                
                  
                  
                  <a
                    href="https://github.com/percona/pxb-docs/edit/2.4/docs/howtos/setting_up_replication.md"
                    title=""
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
                  </a>
                  <a
                    href="https://github.com/percona/pxb-docs/edit/2.4/docs/howtos/setting_up_replication.md"
                    title="View source of this page"
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
                  </a>
                

                <!--
                  Hack: check whether the content contains a h1 headline. If it
                  doesn't, the page title (or respectively site name) is used
                  as the main headline.
                -->
                

                <!-- Markdown content -->
                <h1 id="how-to-setup-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup">How to setup a replica for replication in 6 simple steps with Percona XtraBackup<a class="headerlink" href="#how-to-setup-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup" title="Permanent link">&para;</a></h1>
<p>Data is, by far, the most valuable part of a system. Having a backup done
systematically and available for a rapid recovery in case of failure is
admittedly essential to a system. However, it is not common practice because of
its costs, infrastructure needed or even the boredom associated to the
task. <em>Percona XtraBackup</em> is designed to solve this problem.</p>
<p>You can have almost real-time backups in 6 simple steps by setting up a
replication environment with <em>Percona XtraBackup</em>.</p>
<p><em>Percona XtraBackup</em> is a tool for backing up your data
without interruption. It performs “hot backups” on unmodified versions of
<em>MySQL</em> servers (5.1, 5.5 and 5.6), as well as <em>MariaDB</em> and <em>Percona
Server for MySQL</em>. It is a totally free and open source software distributed only under
the <em>GPLv2</em> license.</p>
<h2 id="all-the-things-you-will-need">All the things you will need<a class="headerlink" href="#all-the-things-you-will-need" title="Permanent link">&para;</a></h2>
<p>Setting up a replica for replication with <em>Percona XtraBackup</em> is a
straightforward procedure. You must have the following things to complete the steps:</p>
<ul>
<li>
<p><code>Source</code> A system with a <em>MySQL</em>-based server installed, configured and
running. This system is called the <code>Source</code>, and is where your data is
stored and used for replication. We assume the following about this
server:</p>
<ul>
<li>
<p>Communication enabled with others by the standard TCP/IP port</p>
</li>
<li>
<p>Installed and configured <em>SSH</em> server</p>
</li>
<li>
<p>Configured user account in the system with the appropriate permissions and privileges</p>
</li>
<li>
<p>Enabled binlogs and the server-id set up to 1</p>
</li>
</ul>
</li>
<li>
<p><code>Replica</code> <em>MySQL</em>-based server installed on another server. This server is
called the <code>Replica</code>. We assume the same configuration as the <code>Source</code>,
except that the server-id on the <code>Replica</code> is 2.</p>
</li>
<li>
<p><code>Percona XtraBackup</code> The backup tool should be installed in
both servers for convenience.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not recommended to mix MySQL variants (Percona Server, MySQL, MariaDB) in your replication setup.  This may produce incorrect <code>xtrabackup_slave_info</code> file when adding a new replica.</p>
</div>
<h2 id="step-1-make-a-backup-on-the-source-and-prepare-it">STEP 1: Make a backup on the <code>Source</code> and prepare it<a class="headerlink" href="#step-1-make-a-backup-on-the-source-and-prepare-it" title="Permanent link">&para;</a></h2>
<p>On the <code>Source</code>, issue the following command to a shell:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>xtrabackup<span class="w"> </span>--backup<span class="w"> </span>--user<span class="o">=</span>yourDBuser<span class="w"> </span>--password<span class="o">=</span>MaGiCdB1<span class="w"> </span>--target-dir<span class="o">=</span>/path/to/backupdir
</code></pre></div>
<p>After this is finished you should see:</p>
<div class="highlight"><pre><span></span><code>xtrabackup: completed OK!
</code></pre></div>
<p>This action copies your <em>MySQL</em> data dir to the <code>/path/to/backupdir</code>
directory. You have told <em>Percona XtraBackup</em> to connect to the database server
using your database user and password, and do a hot backup of all your data in
it (all <em>MyISAM</em>, <em>InnoDB</em> tables and indexes in them).</p>
<p>On the <code>Source</code>, to make the snapshot consistent, prepare the data:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>xtrabackup<span class="w"> </span>--user<span class="o">=</span>yourDBuser<span class="w"> </span>--password<span class="o">=</span>MaGiCdB1<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>--prepare<span class="w"> </span>--target-dir<span class="o">=</span>/path/to/backupdir
</code></pre></div>
<p>Select the path where your snapshot has been taken. If everything is ok
you should see the same OK message.  Now the transaction logs are applied to the
data files, and new ones are created: your data files are ready to be used by
the MySQL server.</p>
<p><em>Percona XtraBackup</em> knows where your data is by reading your my.cnf.
If you have your configuration file in a non-standard place, use the
flag <code>xtrabackup --defaults-file</code> <code>=/location/of/my.cnf</code>.</p>
<p>If you want to skip writing the user name and password every time you want to access <em>MySQL</em>, set the information in <code>.mylogin.cnf</code> as follows:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mysql_config_editor<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--login-path<span class="o">=</span>client<span class="w"> </span>--host<span class="o">=</span>localhost<span class="w"> </span>
--user<span class="o">=</span>root<span class="w"> </span>--password
</code></pre></div>
<p>This setting provides root access to MySQL.</p>
<div class="admonition admonition">
<p class="admonition-title">See also</p>
<p><em>MySQL</em> Documentaiton: <a href="https://dev.mysql.com/doc/refman/5.7/en/mysql-config-editor.html">MySQL Configuration Utility</a></p>
</div>
<h2 id="step-2-copy-backed-up-data-to-the-replica">STEP 2:  Copy backed up data to the <code>Replica</code><a class="headerlink" href="#step-2-copy-backed-up-data-to-the-replica" title="Permanent link">&para;</a></h2>
<p>Use <code>rsync</code> or <code>scp</code> to copy the data from Source to Replica. If you’re
syncing the data directly to replica’s data directory it’s advised to stop the
mysqld there. On the <code>Source</code>, run the following command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>rsync<span class="w"> </span>-avpP<span class="w"> </span>-e<span class="w"> </span>ssh<span class="w"> </span>/path/to/backupdir<span class="w"> </span>Replica:/path/to/mysql/
</code></pre></div>
<p>After data has been copied you can back up the original or previously installed
<em>MySQL</em> <code>datadir</code> (<strong>NOTE</strong>: Make sure mysqld is shut down before you move
the contents of its datadir, or move the snapshot into its datadir.). Run the following command on the <code>Replica</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mv<span class="w"> </span>/path/to/mysql/datadir<span class="w"> </span>/path/to/mysql/datadir_bak
</code></pre></div>
<p>and, on the <code>Replica</code>, move the snapshot from the <code>Source</code> in its place:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>xtrabackup<span class="w"> </span>--move-back<span class="w"> </span>--target-dir<span class="o">=</span>/path/to/mysql/backupdir
</code></pre></div>
<p>After you have copied data to the <code>Replica</code>, make sure the <code>Replica</code> <em>MySQL</em> has the proper permissions:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>chown<span class="w"> </span>mysql:mysql<span class="w"> </span>/path/to/mysql/datadir
</code></pre></div>
<p>In case the ibdata and iblog files are located in different directories outside the datadir, put them in their proper place after the logs have been applied.</p>
<h2 id="step-3-configure-the-source-mysql-server">STEP 3: Configure the <code>Source</code> MySQL server<a class="headerlink" href="#step-3-configure-the-source-mysql-server" title="Permanent link">&para;</a></h2>
<p>On the <code>Source</code>, add the appropriate grant to allow the replica to connect to the source:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="n">REPLICATION</span><span class="w"> </span><span class="n">SLAVE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="w">  </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;$replicaip&#39;</span>
<span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;$replicapass&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Also make sure that firewall rules are correct and that the <code>Replica</code> can connect
to the <code>Source</code>. Test that you can run the mysql client on the <code>Replica</code>,
connect to the <code>Source</code>, and authenticate.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mysql<span class="w"> </span>--host<span class="o">=</span>Source<span class="w"> </span>--user<span class="o">=</span>repl<span class="w"> </span>--password<span class="o">=</span><span class="nv">$replicapass</span>
</code></pre></div>
<p>Verify the privileges.</p>
<div class="highlight"><pre><span></span><code><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">GRANTS</span><span class="p">;</span>
</code></pre></div>
<h2 id="step-4-configure-the-replica-mysql-server">STEP 4: Configure the <code>Replica</code> MySQL server<a class="headerlink" href="#step-4-configure-the-replica-mysql-server" title="Permanent link">&para;</a></h2>
<p>Copy the <code>my.cnf</code> file from the <code>Source</code> to the <code>Replica</code>. On the <code>Replica</code>, run the following:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>scp<span class="w"> </span>user@Source:/etc/mysql/my.cnf<span class="w"> </span>/etc/mysql/my.cnf
</code></pre></div>
<p>then change the following options in /etc/mysql/my.cnf:</p>
<div class="highlight"><pre><span></span><code>server-id=2
</code></pre></div>
<p>and start/restart <code>mysqld</code> on the <code>Replica</code>.</p>
<p>In case you’re using init script on Debian based system to start mysqld, be sure
that the password for <code>debian-sys-maint</code> user has been updated and is the
same as the user’s password on the <code>Source</code>. This password can be seen and
updated in <code>/etc/mysql/debian.cnf</code>.</p>
<h2 id="step-5-start-the-replication">STEP 5: Start the replication<a class="headerlink" href="#step-5-start-the-replication" title="Permanent link">&para;</a></h2>
<p>On the <code>Replica</code>, look at the content of the file <code>xtrabackup_binlog_info</code>, it will be something like:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>cat<span class="w"> </span>/var/lib/mysql/xtrabackup_binlog_info
Source-bin.000001<span class="w">     </span><span class="m">481</span>
</code></pre></div>
<p>Execute the <code>CHANGE MASTER</code> statement on a MySQL console and use the username and password you’ve set up in STEP 3:</p>
<div class="highlight"><pre><span></span><code><span class="n">TheSlave</span><span class="o">*</span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CHANGE</span><span class="w"> </span><span class="n">MASTER</span><span class="w"> </span><span class="k">TO</span>
<span class="w">                </span><span class="n">MASTER_HOST</span><span class="o">=</span><span class="s1">&#39;$sourceip&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="n">MASTER_USER</span><span class="o">=</span><span class="s1">&#39;repl&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="s1">&#39;$replicapass&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="n">MASTER_LOG_FILE</span><span class="o">=</span><span class="s1">&#39;Source-bin.000001&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="n">MASTER_LOG_POS</span><span class="o">=</span><span class="mi">481</span><span class="p">;</span>
</code></pre></div>
<p>and start the replica:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="n">SLAVE</span><span class="p">;</span>
</code></pre></div>
<h2 id="step-6-check">STEP 6: Check<a class="headerlink" href="#step-6-check" title="Permanent link">&para;</a></h2>
<p>On the <code>Replica</code>, check that everything went OK with:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">TheSlave</span><span class="o">|</span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">SLAVE</span><span class="w"> </span><span class="n">STATUS</span><span class="w"> </span><span class="err">\</span><span class="k">G</span>
</code></pre></div>
The results should look like the following:</p>
<div class="highlight"><pre><span></span><code> ...
 Slave_IO_Running: Yes
 Slave_SQL_Running: Yes
 ...
 Seconds_Behind_Master: 13
 ...
</code></pre></div>
<p>Both <code>IO</code> and <code>SQL</code> threads need to be running. The
<code>Seconds_Behind_Master</code> means the <code>SQL</code> currently being executed has a
<code>current_timestamp</code> of 13 seconds ago. It is an estimation of the lag between the
<code>Source</code> and the <code>Replica</code>. Note that at the beginning, a high value could
be shown because the <code>Replica</code> has to “catch up” with the
<code>Source</code>.</p>
<h2 id="adding-more-replicas-to-the-source">Adding more replicas to the Source<a class="headerlink" href="#adding-more-replicas-to-the-source" title="Permanent link">&para;</a></h2>
<p>You can use this procedure with slight variation to add new replicas to a
source. We will use <em>Percona XtraBackup</em> to clone an already configured
replica. We will continue using the previous scenario for convenience but we will
add the <code>NewReplica</code> to the plot.</p>
<p>At the <code>Replica</code>, do a full backup:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>$<span class="w"> </span>xtrabackup<span class="w"> </span>--user<span class="o">=</span>yourDBuser<span class="w"> </span>--password<span class="o">=</span>MaGiCiGaM<span class="w"> </span><span class="se">\</span>
--backup<span class="w"> </span>--slave-info<span class="w"> </span>--target-dir<span class="o">=</span>/path/to/backupdir
</code></pre></div>
<p>By using the <code>xtrabackup --slave-info</code> <em>Percona XtraBackup</em> creates
additional file called xtrabackup_slave_info.</p>
<p>On the <code>Replica</code>, apply the logs:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>xtrabackup<span class="w"> </span>--prepare<span class="w"> </span>--use-memory<span class="o">=</span>2G<span class="w"> </span>--target-dir<span class="o">=</span>/path/to/backupdir/
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the <code>prepare</code> phase, the <code>--use-memory</code> parameter speeds up the process if the amount of RAM assigned to the option is available. Use the parameter only in the <code>prepare</code> phase. In the other phases the parameter makes the application lazy allocate this memory (reserve) but does not affect database pages.</p>
</div>
<p>Copy the directory from the <code>Replica</code> to the <code>NewReplica</code> (<strong>NOTE</strong>: Make sure
mysqld is shut down on the <code>NewReplica</code> before you copy the contents the snapshot
into its <code>datadir</code>.):</p>
<div class="highlight"><pre><span></span><code>rsync<span class="w"> </span>-avprP<span class="w"> </span>-e<span class="w"> </span>ssh<span class="w"> </span>/path/to/backupdir<span class="w"> </span>NewReplica:/path/to/mysql/datadir
</code></pre></div>
<p>On the <code>Source</code>, add additional grant on the source:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="n">REPLICATION</span><span class="w"> </span><span class="n">SLAVE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="w">  </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;repl&#39;</span><span class="o">@</span><span class="s1">&#39;$newreplicaip&#39;</span>
<span class="w">                 </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;$replicapass&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Copy the configuration file from the <code>Replica</code>. On the <code>NewReplica</code>, run the following command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>scp<span class="w"> </span>user@Replica:/etc/mysql/my.cnf<span class="w"> </span>/etc/mysql/my.cnf
</code></pre></div>
<p>Make sure you change the server-id variable in <code>/etc/mysql/my.cnf</code> to 3
and disable the replication on start:</p>
<div class="highlight"><pre><span></span><code>skip-slave-start
server-id=3
</code></pre></div>
<p>After setting <code>server_id</code>, start <code>mysqld</code>.</p>
<p>Fetch the master_log_file and master_log_pos from the file
<code>xtrabackup_slave_info</code>, execute the statement for setting up the source
and the log file for the <code>NewReplica</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">TheNEWSlave</span><span class="o">|</span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CHANGE</span><span class="w"> </span><span class="n">MASTER</span><span class="w"> </span><span class="k">TO</span>
<span class="w">                   </span><span class="n">MASTER_HOST</span><span class="o">=</span><span class="s1">&#39;$sourceip&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="n">MASTER_USER</span><span class="o">=</span><span class="s1">&#39;repl&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="n">MASTER_PASSWORD</span><span class="o">=</span><span class="s1">&#39;$replicapass&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="n">MASTER_LOG_FILE</span><span class="o">=</span><span class="s1">&#39;Source-bin.000001&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="n">MASTER_LOG_POS</span><span class="o">=</span><span class="mi">481</span><span class="p">;</span>
</code></pre></div>
<p>and start the replica:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">START</span><span class="w"> </span><span class="n">SLAVE</span><span class="p">;</span>
</code></pre></div>
<p>If both IO and SQL threads are running when you check the the <code>NewReplica</code>,
server is replicating the <code>Source</code>.</p>
<div class="admonition admoniton">
<p class="admonition-title">See also</p>
<p><a href="recipes_ibkx_gtid.html">How to create a new (or repair a broken) GTID based slave</a></p>
</div>

                
<div class="md-relbar2__inner md-grid">
<div class="md-content">
  <article class="md-content__inner md-typeset" role="main">    
    <h3>Contact us </h3>
       <p>For free technical help, visit the Percona <a class="reference external" href="https://forums.percona.com/c/mysql-mariadb/percona-xtrabackup/10?utm_campaign=Doc%20pages" target="_blank">Community Forum</a>.<br>
        <p>To report bugs or submit feature requests, open a <a class="reference external" href="https://jira.percona.com/projects/PXB/issues/" target="_blank">JIRA</a> ticket.<br>
         <p>For paid <a class="reference external" href="https://www.percona.com/services/support"> support </a> and <a class="reference external" href="https://www.percona.com/services/managed-services"> managed </a> or <a class="reference external" href="https://www.percona.com/services/consulting">consulting services </a>, contact <a class="reference external" href="https://www.percona.com/about-percona/contact" target="_blank">Percona Sales</a>.</p>
 </article>
</div>
</div>

                <!-- Last update of source file -->
                
                  
                    <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2023-01-30
    
  </small>
</div>
                  
                
              
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Percona LLC, &#169; 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "navigation.top", "content.tabs.link", "content.code.copy", "navigation.tracking", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
              
      <script src="../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="../js/version-select.js"></script>
      
        <script src="../js/promptremover.js"></script>
      
    

              <img src="https://tracking.g2crowd.com/attribution_tracking/conversions/1007137.gif?e=" width="1" height="1" />

              <noscript>
                <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K48FGP2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
              </noscript>
              
  </body>
</html>